<!DOCTYPE html>

<html>
    <head>
        <link rel="stylesheet" href="style.css">
        <title>DefAssembler</title>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico?">
    </head>

    <body>
        <header>
            <h1>DefAssembler</h1>
            <div id="bytes-container">
                <div id="bytes-control">
                    <select id="bytes-format">
                        <option value="hex">Hex</option>
                        <option value="unicode">Unicode</option>
                    </select>
                    <select id="bytes-section">
                        <option value="all">All</option>
                        <option value=".text">.text</option>
                        <option value=".data">.data</option>
                        <option value=".bss">.bss</option>
                    </select>
                    <span id="byte-count"></span>
                </div>
                <div id="bytes-span"></div>
            </div>
            <div id="shellcodeContainer">
                main=<span style="color: #666">"<span id="shellcode"></span>"</span>;
            </div> 
        </header>

        <div class="defasm-editor" keep-code>SYS_WRITE = 1
SYS_EXIT = 60
STDOUT_FILENO = 1

# Printing
.data
buffer: .string "Hello, world!\n"
bufferLen = . - buffer

.text
mov $SYS_WRITE, %eax
mov $STDOUT_FILENO, %edi
mov $buffer, %esi
mov $bufferLen, %edx
syscall

# Looping
.data
digit: .byte '0', '\n'

.text
mov $10, %bl
numberLoop:
    mov $SYS_WRITE, %eax
    mov $STDOUT_FILENO, %edi
    mov $digit, %esi
    mov $2, %edx
    syscall

    incb (%rsi)
    dec %bl
    jnz numberLoop

# Accessing arguments
pop %rbx
pop %rax

argLoop:
    dec %ebx
    jz endArgLoop

    pop %rsi
    mov %rsi, %rdi

    mov $-1, %ecx
    xor %al, %al
    repnz scasb

    not %ecx
    movb $'\n', -1(%rsi, %rcx)

    mov %ecx, %edx
    mov $SYS_WRITE, %eax
    mov $STDOUT_FILENO, %edi
    syscall

    jmp argLoop
endArgLoop:

mov $SYS_EXIT, %eax
mov $0, %edi
syscall</div>
    </body>

    <script src="index.js"></script>
</html>